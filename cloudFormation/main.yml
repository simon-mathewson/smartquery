Resources:
  BastionStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/bastion.yml"

  CloudFrontStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/cloudFront.yml"
    DependsOn:
      - VPCStack

  CodeBuildStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/codeBuild.yml"
    DependsOn:
      - CloudFrontStack
      - IamStack
      - RDSStack
      - SecretsManagerStack
      - VPCStack

  CodePipelineStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/codePipeline.yml"
    DependsOn:
      - CodeBuildStack
      - CodeStarConnectionsStack
      - IamStack
      - S3Stack

  CodeStarConnectionsStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/codeStarConnections.yml"

  CognitoStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/cognito.yml"

  ElasticBeanstalkStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/elasticBeanstalk.yml"
    DependsOn:
      - RDSStack
      - SecretsManagerStack
      - VPCStack

  IamStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/iam.yml"
    DependsOn:
      - CloudFrontStack
      - S3Stack

  RDSStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/rds.yml"
      Parameters:
        DabaseCloudDbSecretArn: !ImportValue DabaseCloudDbSecretArn
    DependsOn:
      - SecretsManagerStack
      - VPCStack

  Route53Stack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/route53.yml"
    DependsOn:
      - BastionStack
      - CloudFrontStack
      - ElasticBeanstalkStack
      - SESStack

  RUMStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/rum.yml"
    DependsOn:
      - CognitoStack

  S3Stack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/s3.yml"

  SESStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/ses.yml"

  SecretsManagerStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/secretsManager.yml"

  VPCStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/vpc.yml"

  WAFStack:
    Type: "AWS::CloudFormation::Stack"
    DeletionPolicy: "Delete"
    UpdateReplacePolicy: "Delete"
    Properties:
      TemplateURL: "https://dabase-cloudformation.s3.eu-central-1.amazonaws.com/waf.yml"
    DependsOn:
      - ElasticBeanstalkStack
